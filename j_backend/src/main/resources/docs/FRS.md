# 기능 요구사항 명세서 (FRS)

**Antock Public Data Harvester**

## 개요

본 문서는 공공데이터 수집 및 관리 시스템의 기능 요구사항을 정의합니다. 시스템은 법인 정보 관리, 회원 관리, 파일 관리, 대시보드 등의 핵심 기능을 제공합니다.

---

## 1. 사용자 인증 및 권한 관리

### 1.1 회원가입

- **일반 사용자**
  - 사용자명(영문/숫자/언더스코어, 4-20자), 비밀번호(영문+숫자 조합, 6-50자), 닉네임(2-20자), 이메일 기반 가입
  - 이메일 중복 확인
  - 비밀번호 암호화 처리 (BCrypt)
  - 회원가입 후 관리자 승인 대기 상태

### 1.2 로그인

- **일반 사용자**

  - 사용자명, 비밀번호 기반 로그인
  - 로그인 실패 제한 5회 (계정 잠금)
  - JWT 토큰 기반 인증
  - Rate Limiting 적용 (Redis/메모리 기반)

- **관리자**
  - 사용자명, 비밀번호 기반 로그인
  - 동일한 보안 정책 적용

### 1.3 권한 관리

- **사용자 역할 분리**
  - USER: 일반 사용자 권한
  - MANAGER: 매니저 권한
  - ADMIN: 관리자 권한
- **계정 상태 관리**
  - PENDING: 승인 대기
  - APPROVED: 승인 완료
  - SUSPENDED: 정지
  - REJECTED: 거부
  - WITHDRAWN: 탈퇴

### 1.4 비밀번호 관리

- 비밀번호 변경 기능
- 비밀번호 만료 관리 (스케줄러 기반)
- 비밀번호 변경 이력 관리
- 이전 비밀번호 재사용 방지

---

## 2. 법인 정보 관리 (CorpMast)

### 2.1 법인 정보 검색

- **검색 조건**
  - 법인명 (부분 일치, 대소문자 무관)
  - 사업자번호 (하이픈 포함/제외 모두 가능)
  - 판매자 ID
  - 법인등록번호
  - 지역 (시/도, 구/군)

### 2.2 법인 정보 조회

- **상세 정보**
  - 법인 고유 ID, 판매자 ID, 법인명, 사업자번호
  - 법인등록번호, 지역코드, 시/도명, 구/군명
  - 등록자 정보, 생성/수정 일시
  - 포맷된 사업자번호 (하이픈 포함)
  - 전체 주소 조합

### 2.3 법인 데이터 관리

- **Excel 내보내기**
  - 검색 조건에 따른 데이터 Excel 파일 다운로드
- **메타데이터 조회**
  - 시/도 목록 조회
  - 구/군 목록 조회 (시/도별)
  - 검색 통계 정보

### 2.4 CSV 배치 처리

- **공동판매자 데이터 처리**
  - CSV 파일 읽기 (Local/MinIO 지원)
  - 외부 API 연동 (법인정보, 지역정보)
  - 배치 스케줄링 (Cron 기반)
  - 이력 관리

---

## 3. 파일 관리

### 3.1 파일 업로드

- **업로드 기능**
  - 멀티파트 파일 업로드
  - 파일 크기 제한 (최대 100MB)
  - 파일 유형 검증
  - Local/MinIO 스토리지 지원

### 3.2 파일 관리

- **CRUD 기능**
  - 파일 정보 조회/수정/삭제
  - 파일 설명 수정
  - 파일 검색 (키워드 기반)
  - 파일 목록 조회 (페이징)

### 3.3 파일 다운로드

- **다운로드 기능**
  - 파일 ID 기반 다운로드
  - 스트리밍 다운로드 지원
  - 파일 메타데이터 제공

---

## 4. 대시보드 및 통계

### 4.1 지역별 통계

- **통계 데이터**
  - 지역별 법인 수
  - 최상위 지역 통계
  - 전체 지역 통계 목록
  - 완성도 비율 계산

### 4.2 시스템 모니터링

- **성능 메트릭**
  - 시스템 리소스 사용량
  - 애플리케이션 성능 지표
  - 데이터베이스 성능 모니터링

---

## 5. 관리자 기능

### 5.1 회원 관리

- **회원 승인/거부**
  - 승인 대기 회원 목록 조회
  - 회원 승인/거부 처리
  - 회원 상태 변경 (정지/해제)
  - 회원 역할 변경

### 5.2 데이터 관리

- **더미 데이터 생성**
  - 테스트용 회원 데이터 생성
  - 배치 크기 설정
  - 강제 초기화 옵션
  - 생성 통계 제공

### 5.3 캐시 관리

- **캐시 모니터링**
  - 캐시 히트/미스 통계
  - 캐시 사용량 모니터링
  - 개별/전체 캐시 무효화
  - Redis 상태 확인

### 5.4 Rate Limiting 관리

- **속도 제한 관리**
  - 현재 Rate Limit 상태 조회
  - Rate Limit 재설정
  - 식별자 차단/해제
  - 화이트리스트 관리
  - 보안 정보 조회

---

## 6. 보안 및 성능

### 6.1 보안 기능

- **JWT 토큰 인증**
  - Access Token 기반 인증
  - 토큰 만료 처리
  - 권한별 접근 제어

### 6.2 Rate Limiting

- **요청 제한**
  - Redis/메모리 기반 Rate Limiting
  - 식별자별 요청 횟수 제한
  - 자동 차단 및 해제
  - 위반 추적 및 통계

### 6.3 캐싱

- **다중 캐시 전략**
  - Redis 기반 분산 캐시
  - 메모리 기반 로컬 캐시
  - 캐시 Fallback 메커니즘

---

## 7. 외부 API 연동

### 7.1 법인정보 API

- 사업자등록번호 기반 법인정보 조회
- 법인등록번호 검증

### 7.2 지역정보 API

- 주소 기반 지역코드 조회
- 행정구역 정보 획득

---

## 8. 시스템 관리

### 8.1 스케줄링

- **배치 작업**
  - CSV 데이터 처리 스케줄링
  - 비밀번호 만료 알림
  - 계정 잠금 해제
  - 시스템 정리 작업

### 8.2 로깅 및 모니터링

- **로그 관리**
  - 구조화된 로그 출력
  - 성능 로그 (슬로우 쿼리)
  - 보안 이벤트 로그

### 8.3 헬스체크

- **시스템 상태 확인**
  - Redis 연결 상태
  - 캐시 시스템 상태
  - 데이터베이스 연결 상태

---

## 9. API 문서화

### 9.1 Swagger UI

- **API 문서**
  - RESTful API 명세
  - 인터랙티브 API 테스트
  - 스키마 정의
  - 예제 요청/응답

### 9.2 API 보안

- **인증 방식**
  - Bearer Token (JWT)
  - API Key 기반 인증
  - 역할 기반 접근 제어

---

## 10. 웹 인터페이스

### 10.1 관리자 웹

- **웹 기반 관리 도구**
  - 법인 정보 검색/조회
  - 회원 관리 인터페이스
  - 파일 관리 도구
  - 대시보드 UI

### 10.2 사용자 인터페이스

- **웹 페이지**
  - 로그인/회원가입 페이지
  - 프로필 관리 페이지
  - 비밀번호 변경 페이지
  - CKEditor 통합 (리치 텍스트 편집)

---

## 기술 스택

- **Backend**: Spring Boot 3.4.4, Java
- **Database**: JPA/Hibernate, H2/MySQL
- **Cache**: Redis
- **Security**: Spring Security, JWT
- **API Documentation**: Swagger/OpenAPI 3
- **File Storage**: Local Storage, MinIO
- **Testing**: JUnit 5, Mockito, Testcontainers
- **Build**: Gradle
- **Frontend**: JSP, Bootstrap, CKEditor
